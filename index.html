<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Super Mario Memory</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <audio id="bgMusic" loop><source src="audio/theme.mp3" type="audio/mpeg"></audio>
    <audio id="sfxPause"><source src="audio/pause.mp3" type="audio/mpeg"></audio>
    <audio id="sfxGameOver"><source src="audio/gameover.mp3" type="audio/mpeg"></audio>
    <audio id="sfxWin"><source src="audio/win.mp3" type="audio/mpeg"></audio>
    <audio id="sfxBowser"><source src="audio/bowser.mp3" type="audio/mpeg"></audio>
    <audio id="sfx1up"><source src="audio/1up.mp3" type="audio/mpeg"></audio>
    <audio id="sfxStar"><source src="audio/powerfull.mp3" type="audio/mpeg"></audio>
    <audio id="sfxFireball"><source src="audio/fireball.mp3" type="audio/mpeg"></audio>
    <audio id="sfxBoo"><source src="audio/boo.mp3" type="audio/mpeg"></audio>
    <audio id="sfxFlip"><source src="audio/flip.mp3" type="audio/mpeg"></audio>
    <audio id="sfxStart"><source src="audio/start.mp3" type="audio/mpeg"></audio>
    <audio id="sfxSplat"><source src="audio/splat.mp3" type="audio/mpeg"></audio>
    <audio id="sfxKamek"><source src="audio/kamek.mp3" type="audio/mpeg"></audio>
    <audio id="sfxExplosion"><source src="audio/explosion.mp3" type="audio/mpeg"></audio>
    <audio id="sfxShyGuy"><source src="audio/shyguy.mp3" type="audio/mpeg"></audio>
    <audio id="sfxSwish"><source src="audio/swish.mp3" type="audio/mpeg"></audio>
    <!-- Son pour l'achat -->
    <audio id="sfxCoin"><source src="audio/coin.mp3" type="audio/mpeg"></audio>

    <div class="overlay active" id="startMenu">
        <div class="menu-box">
            <h2 style="margin-top:0">CHOISIS TON NIVEAU</h2>

            <div class="wallet-display">
                <img src="images/coin.png" alt="Pi√®ce">
                <span id="menuWallet">0</span>
            </div>

            <button class="btn-level" onclick="openSelectionMenu('easy')">FACILE (5 Vies)</button>
            <button class="btn-level" onclick="openSelectionMenu('medium')">MOYEN (10 Vies)</button>
            <button class="btn-level" onclick="openSelectionMenu('hard')">DIFFICILE (15 Vies)</button>

            <!-- BOUTON SHOP AJOUT√â (Modifi√© avec l'image de Toad) -->
            <button class="btn-level btn-shop" onclick="openShopMenu()">
                <img src="images/toadshop.png" style="height: 28px; vertical-align: middle; margin-right: 5px; margin-bottom: 4px;"> TOAD SHOP
            </button>

            <div style="display: flex; gap: 10px; justify-content: center; width: 100%;">
                <button class="btn-level btn-custom" style="width: 48%; margin: 15px 0;" onclick="openCustomMenu()">üõ†Ô∏è PERSO</button>
                <button class="btn-level btn-skin" style="width: 48%; margin: 15px 0;" onclick="openSkinMenu()">üé® SKINS</button>
            </div>

            <button class="btn-level btn-bg" onclick="openBgMenu()">üåà FOND D'√âCRAN</button>

            <div style="display: flex; gap: 10px; justify-content: center; width: 100%;">
                <button class="btn-level btn-music" style="width: 48%; margin: 15px 0;" onclick="openMusicMenu()">üéµ MUSIQUE</button>
                <button class="btn-level btn-album" style="width: 48%; margin: 15px 0;" onclick="openAlbumMenu()">üìí ALBUM</button>
            </div>

            <button class="btn-level btn-reset" onclick="resetBestScores()">üóëÔ∏è EFFACER SCORES</button>
        </div>
    </div>

    <!-- NOUVEAU MENU SHOP -->
    <div class="overlay" id="shopMenu">
        <div class="menu-box" style="max-width: 800px;">
            <div style="display:flex; align-items:center; justify-content:center; gap:15px;">
                <!-- Image mise √† jour pour le Toad Shop (cercle rouge retir√©) -->
                <img src="images/toadshop.png" style="height:100px; border-radius: 50%;">
                <h2 style="margin:0; color:#E52521; font-size: 2.5rem; text-shadow: 2px 2px 0 #000;">TOAD SHOP</h2>
            </div>
            <p>D√©pense tes pi√®ces pour acheter des bonus utilisables en jeu !</p>

            <div class="wallet-display large">
                <img src="images/coin.png" alt="Pi√®ce">
                <span id="shopWallet">0</span>
            </div>

            <div class="shop-grid">
                <!-- Item 1: Champignon -->
                <div class="shop-item">
                    <div class="item-icon"><img src="images/1up.png"></div>
                    <div class="item-info">
                        <h3>Champi Vie</h3>
                        <p>+1 Vie en pleine partie.</p>
                        <div class="price">200 <img src="images/coin.png"></div>
                    </div>
                    <div class="item-action">
                        <span class="stock" id="stock-mushroom">x0</span>
                        <button class="btn-buy" onclick="buyItem('mushroom', 200)">ACHETER</button>
                    </div>
                </div>

                <!-- Item 2: Montre -->
                <div class="shop-item">
                    <div class="item-icon"><span style="font-size:3rem">‚è∞</span></div>
                    <div class="item-info">
                        <h3>Chrono +</h3>
                        <p>Ajoute +15 secondes.</p>
                        <div class="price">150 <img src="images/coin.png"></div>
                    </div>
                    <div class="item-action">
                        <span class="stock" id="stock-clock">x0</span>
                        <button class="btn-buy" onclick="buyItem('clock', 150)">ACHETER</button>
                    </div>
                </div>

                <!-- Item 3: Etoile -->
                <div class="shop-item">
                    <div class="item-icon"><img src="images/star.png"></div>
                    <div class="item-info">
                        <h3>Super √âtoile</h3>
                        <p>R√©v√®le tout pendant 3s.</p>
                        <div class="price">500 <img src="images/coin.png"></div>
                    </div>
                    <div class="item-action">
                        <span class="stock" id="stock-star">x0</span>
                        <button class="btn-buy" onclick="buyItem('star', 500)">ACHETER</button>
                    </div>
                </div>

                <!-- Item 4: Fleur de Feu -->
                <div class="shop-item">
                    <div class="item-icon"><img src="images/fireflower.png"></div>
                    <div class="item-info">
                        <h3>Fleur de Feu</h3>
                        <p>Trouve une paire auto.</p>
                        <div class="price">300 <img src="images/coin.png"></div>
                    </div>
                    <div class="item-action">
                        <span class="stock" id="stock-fireflower">x0</span>
                        <button class="btn-buy" onclick="buyItem('fireflower', 300)">ACHETER</button>
                    </div>
                </div>

                <!-- Item 5: Fleur de Glace -->
                <div class="shop-item">
                    <div class="item-icon"><img src="images/iceflower.png"></div>
                    <div class="item-info">
                        <h3>Fleur de Glace</h3>
                        <p>G√®le le temps (10s).</p>
                        <div class="price">300 <img src="images/coin.png"></div>
                    </div>
                    <div class="item-action">
                        <span class="stock" id="stock-iceflower">x0</span>
                        <button class="btn-buy" onclick="buyItem('iceflower', 300)">ACHETER</button>
                    </div>
                </div>

                <!-- Item 6: Bloc ? -->
                <div class="shop-item" style="border-color: #FBD000; background: #fffde7;">
                    <div class="item-icon"><img src="images/block.png"></div>
                    <div class="item-info">
                        <h3 style="color:#b8860b">Bloc Surprise</h3>
                        <p>Utilise un objet au hasard !</p>
                        <div class="price">250 <img src="images/coin.png"></div>
                    </div>
                    <div class="item-action">
                        <span class="stock" id="stock-mysteryblock" style="background:#b8860b;">x0</span>
                        <button class="btn-buy" style="background:#FBD000; color:#b85c00;" onclick="buyItem('mysteryblock', 250)">ACHETER</button>
                    </div>
                </div>
            </div>

            <button class="btn-menu" style="margin-top: 20px;" onclick="goToMainMenu()">RETOUR</button>
        </div>
    </div>

    <div class="overlay" id="albumMenu">
        <!-- ... (Contenu existant de l'album) ... -->
        <div class="menu-box" style="max-width: 800px;">
            <h2 style="margin-top:0; color:#FFD700;">ALBUM DE COLLECTION</h2>
            <p id="albumProgress">Progression : 0 / 0</p>

            <div class="album-preview-box">
                <img id="previewImg" src="images/block.png" alt="Aper√ßu">
                <h3 id="previewName">Survole un sticker !</h3>
            </div>

            <div class="album-grid" id="albumGrid">
            </div>

            <button class="btn-menu" style="background: #555; border-color: #999; margin-top: 20px;" onclick="goToMainMenu()">RETOUR</button>
        </div>
    </div>

    <div class="overlay" id="skinMenu">
        <!-- ... (Contenu existant des skins) ... -->
        <div class="menu-box">
            <h2 style="margin-top:0; color:#049CD8;">DOS DES CARTES</h2>
            <p>Gagne des parties pour d√©bloquer des styles !</p>

            <div class="skin-grid">
                <div class="skin-option" id="skin-block-option" onclick="selectSkin('skin-block')">
                    <img src="images/block.png" alt="Bloc ?">
                    <span>Classique</span>
                    <div class="skin-status">Gratuit</div>
                </div>

                <div class="skin-option" id="skin-pipe-option" onclick="selectSkin('skin-pipe')">
                    <div class="lock-overlay">üîí</div>
                    <img src="images/pipe.png" alt="Tuyau">
                    <span>Tuyau</span>
                    <div class="skin-status" id="progress-skin-pipe">0 / 15 (Facile)</div>
                </div>

                <div class="skin-option" id="skin-coin-option" onclick="selectSkin('skin-coin')">
                    <div class="lock-overlay">üîí</div>
                    <img src="images/coin.png" alt="Pi√®ce">
                    <span>Pi√®ce</span>
                    <div class="skin-status" id="progress-skin-coin">0 / 10 (Moyen)</div>
                </div>

                <div class="skin-option" id="skin-gold-option" onclick="selectSkin('skin-gold')">
                    <div class="lock-overlay">üîí</div>
                    <img src="images/goldblock.png" alt="Or">
                    <span>Bloc Or</span>
                    <div class="skin-status" id="progress-skin-gold">0 / 5 (Difficile)</div>
                </div>
            </div>

            <button class="btn-menu" style="margin-top: 20px;" onclick="goToMainMenu()">VALIDER</button>
        </div>
    </div>

    <div class="overlay" id="bgMenu">
        <!-- ... (Contenu existant du menu fond) ... -->
        <div class="menu-box">
            <h2 style="margin-top:0; color:#FF5733;">PERSONNALISER LE FOND</h2>

            <div class="bg-mode-switch">
                <button id="btnEditLight" class="btn-mode" onclick="switchBgMode('light')">‚òÄÔ∏è MODE CLAIR</button>
                <button id="btnEditDark" class="btn-mode" onclick="switchBgMode('dark')">üåô MODE SOMBRE</button>
            </div>

            <p id="bgEditTitle" style="margin: 5px 0; font-style: italic; color: #666;">Couleurs actuelles :</p>

            <div class="color-picker-container">
                <div class="color-option">
                    <label>Couleur Principale</label>
                    <input type="color" id="bgColorInput" value="#5C94FC">
                </div>
                <div class="color-option">
                    <label>Couleur des Rayures</label>
                    <input type="color" id="bgLineInput" value="#6C9FFC">
                </div>
            </div>

            <button class="btn-menu" style="background: #333; border-color: #999; margin-top: 20px;" onclick="resetBackground()">‚Ü∫ D√âFAUT (Mode Actuel)</button>
            <button class="btn-menu" style="margin-top: 10px;" onclick="goToMainMenu()">VALIDER</button>
        </div>
    </div>

    <div class="overlay" id="musicMenu">
        <!-- ... (Contenu existant du menu musique) ... -->
        <div class="menu-box" style="max-width: 500px;">
            <h2 style="margin-top:0; color:#9b59b6;">JUKEBOX MARIO üéµ</h2>
            <p>Choisis la musique de ta partie :</p>

            <button class="btn-menu btn-random" style="width: 100%; margin-bottom: 15px;" onclick="selectRandomMusic()">üîÄ SURPRENDS-MOI !</button>

            <div id="musicList" class="music-list-container">
            </div>

            <button class="btn-menu" style="margin-top: 20px;" onclick="goToMainMenu()">VALIDER</button>
        </div>
    </div>

    <div class="overlay" id="customMenu">
        <!-- ... (Contenu existant menu perso) ... -->
        <div class="menu-box">
            <h2 style="margin-top:0; color:#9b59b6;">PARTIE PERSO</h2>

            <div style="margin: 15px 0; text-align: left;">
                <div class="custom-label"><span>Paires</span> <b id="customPairsVal">8</b></div>
                <input type="range" id="customPairs" class="custom-range" min="2" max="39" value="8" oninput="document.getElementById('customPairsVal').innerText = this.value">
            </div>

            <div style="margin: 15px 0; text-align: left;">
                <div class="custom-label"><span>Vies</span> <b id="customLivesVal">10</b></div>
                <input type="range" id="customLives" class="custom-range" min="1" max="99" value="10" oninput="document.getElementById('customLivesVal').innerText = this.value">
            </div>

            <div style="margin: 15px 0; text-align: left;">
                <div class="custom-label"><span>Temps</span> <b id="customTimeVal">60s</b></div>
                <input type="range" id="customTime" class="custom-range" min="10" max="300" step="10" value="60" oninput="document.getElementById('customTimeVal').innerText = this.value + 's'">
            </div>

            <div style="display: flex; justify-content: center; gap: 10px;">
                <button class="btn-menu" style="background: #555; border-color: #999; width: 40%;" onclick="goToMainMenu()">RETOUR</button>
                <button class="btn-level btn-custom" style="width: 60%; margin: 10px 0;" onclick="setupCustomGame()">SUIVANT ‚û°</button>
            </div>
        </div>
    </div>

    <div class="overlay" id="selectionMenu">
        <!-- ... (Contenu existant s√©lection) ... -->
        <div class="menu-box">
            <h2 style="margin-top:0">CHOISIS TON √âQUIPE</h2>
            <p id="selectionTitle">S√©lectionne 6 personnages</p>

            <div class="select-container" id="selectionGrid"></div>

            <p id="charDescription" class="char-description">Survole un personnage pour voir son effet.</p>

            <div style="display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;">
                <button class="btn-menu" style="width: 150px; background: #555; border-color: #999;" onclick="goToMainMenu()">RETOUR</button>
                <button class="btn-menu btn-deselect" style="width: 160px;" onclick="deselectAll()">‚ùå TOUT VIDER</button>
                <button class="btn-menu btn-random" style="width: 180px;" onclick="randomSelection()">üé≤ AL√âATOIRE</button>
                <button id="btnStartGame" class="btn-menu btn-disabled" style="width: 150px;" onclick="confirmSelection()">JOUER !</button>
            </div>
        </div>
    </div>

    <div class="overlay" id="countdownOverlay">
        <div id="countdownText">3</div>
    </div>

    <div class="overlay" id="pauseMenu">
        <div class="menu-box">
            <h2 style="margin-top:0; color:#E52521">PAUSE</h2>
            <button class="btn-menu" onclick="togglePause()">‚ñ∂ REPRENDRE</button>
            <button class="btn-menu" onclick="restartCurrentLevel()">RECOMMENCER</button>
            <button class="btn-menu" onclick="goToMainMenu()">MENU PRINCIPAL</button>
        </div>
    </div>

    <div class="overlay" id="helpMenu">
        <!-- ... (Contenu existant aide) ... -->
        <div class="menu-box" style="max-width: 600px; text-align: left;">
            <h2 style="margin-top:0; color:#E52521; text-align: center;">GUIDE DES POUVOIRS</h2>

            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                <img src="images/star.png" style="width: 50px; margin-right: 15px;">
                <div><strong style="color: #FBD000;">SUPER √âTOILE :</strong> R√©v√®le toutes les cartes pendant un court instant.</div>
            </div>
            <!-- ... (autres aides) ... -->
            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                <img src="images/fireflower.png" style="width: 50px; margin-right: 15px;">
                <div><strong style="color: #ff4d4d;">FLEUR DE FEU :</strong> Lance une boule de feu qui trouve et valide une paire pour vous !</div>
            </div>
            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                <img src="images/1up.png" style="width: 50px; margin-right: 15px;">
                <div><strong style="color: #44D62C;">1-UP :</strong> Vous gagnez une vie suppl√©mentaire !</div>
            </div>

            <div style="display: flex; align-items: center; margin-bottom: 15px; border-top: 2px solid #555; padding-top: 15px;">
                <img src="images/ghost.png" style="width: 50px; margin-right: 15px;">
                <div><strong style="color: #ccc;">BOO (PI√àGE):</strong> Hante l'√©cran et le rend flou jusqu'√† votre prochain coup.</div>
            </div>
            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                <img src="images/blooper.png" style="width: 50px; margin-right: 15px;">
                <div><strong style="color: #049CD8;">BLOOPER (PI√àGE) :</strong> Crache de l'encre sur l'√©cran pour cacher la vue !</div>
            </div>
            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                <img src="images/kamek.png" style="width: 50px; margin-right: 15px;">
                <div><strong style="color: #3498db;">KAMEK (PI√àGE) :</strong> Utilise sa magie pour √©changer la place de quelques cartes !</div>
            </div>
            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                <img src="images/bowser.png" style="width: 50px; margin-right: 15px;">
                <div><strong style="color: #44D62C;">BOWSER (PI√àGE) :</strong> Le grand m√©chant ! Il m√©lange toutes les cartes restantes.</div>
            </div>
            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                <img src="images/bobomb.png" style="width: 50px; margin-right: 15px;">
                <div><strong style="color: #ff3333;">BOB-OMB (PI√àGE) :</strong> N'y touchez pas ! Si vous trouvez la paire, elle explose et vous perdez 1 vie.</div>
            </div>
            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                <img src="images/iceflower.png" style="width: 50px; margin-right: 15px;">
                <div><strong style="color: #00ffff;">FLEUR DE GLACE (PI√àGE) :</strong> G√®le l'√©cran et vous emp√™che de jouer, mais le chrono continue de tourner !</div>
            </div>
            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                <img src="images/chainchomp.png" style="width: 50px; margin-right: 15px;">
                <div><strong style="color: #555;">CHOMP (PI√àGE) :</strong> Il mord le plateau et encha√Æne plusieurs cartes pendant 10 secondes !</div>
            </div>
            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                <img src="images/lightning.png" style="width: 50px; margin-right: 15px;">
                <div><strong style="color: #FFFF00;">√âCLAIR (PI√àGE) :</strong> Un flash aveuglant r√©tr√©cit toutes les cartes, les rendant difficiles √† cliquer !</div>
            </div>
            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                <img src="images/poison.png" style="width: 50px; margin-right: 15px;">
                <div><strong style="color: #8A2BE2;">CHAMPI POISON (PI√àGE) :</strong> Un gaz toxique renverse tout votre √©cran √† l'envers pendant 10 secondes !</div>
            </div>
            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                <img src="images/shyguy.png" style="width: 50px; margin-right: 15px;">
                <div><strong style="color: #ff69b4;">MASKASS (PI√àGE) :</strong> Il effraie les cartes ! Elles fuient votre souris pendant 8 secondes.</div>
            </div>
            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                <img src="images/cherry.png" style="width: 50px; margin-right: 15px;">
                <div><strong style="color: #ff69b4;">DOUBLE CERISE (PI√àGE) :</strong> Cr√©e un clone de votre curseur pour vous embrouiller !</div>
            </div>

            <div style="text-align: center; margin-top: 20px;">
                <button class="btn-menu" onclick="toggleHelp()">J'AI COMPRIS !</button>
            </div>
        </div>
    </div>

    <div class="bowser-msg" id="bowserMsg">LES CARTES ONT √âT√â M√âLANG√âES !</div>

    <h1>Super Mario Memory</h1>
    <div class="info-panel">
        <span class="info-item" style="position: relative;">
            ‚è∞ <b id="timer">00</b>
            <span id="timeBonusIndicator" class="bonus-indicator">+5s</span>
        </span>
        <span class="info-item" style="position: relative;">
            ‚ù§Ô∏è <b id="lives">0</b>
            <span id="lifeBonusIndicator" class="bonus-indicator" style="color:#44D62C;">+1</span>
        </span>
        <span class="info-item">
            ‚≠ê <b id="score">0</b>
            <small>(<span id="multiplierDisplay">x1</span>)</small>
        </span>
        <span class="info-item">üèÜ <b id="bestScore">0</b></span>

        <div class="progress-container" title="Progression">
            <div id="progressBar"></div>
        </div>

        <!-- ZONE D'INVENTAIRE AJOUT√âE DANS LE HUD -->
        <div id="inventoryContainer" class="inventory-container"></div>

        <div class="volume-control">
            <button class="btn-mute" id="muteBtn" onclick="toggleMute()">üîâ</button>
            <input type="range" id="volumeSlider" min="0" max="1" step="0.1" value="0.3">
        </div>

        <button class="hud-btn btn-theme" id="themeBtn" onclick="toggleTheme()">üåó</button>
        <button class="hud-btn" onclick="togglePause()">‚è∏ MENU</button>
        <button class="hud-btn btn-theme" onclick="toggleHelp()">?</button>
    </div>

    <div id="activeEffectsContainer" class="effects-container">
    </div>

    <div class="memory-game" id="gameBoard"></div>

    <div class="end-msg" id="winMessage" style="background: rgba(0,0,0,0.95);">
        <div id="newRecordMsg" class="new-record-text">NOUVEAU RECORD !</div>
        <h2 style="color: #FBD000;">VICTOIRE !</h2>
        <div class="score-table">
            <div class="score-row"><span>Paires & Combos :</span><span id="detailBase">0</span></div>
            <div class="score-row"><span>Bonus Rapidit√© :</span><span id="detailTime">0</span></div>
            <div class="score-row"><span>Bonus Survie :</span><span id="detailLife">0</span></div>
            <!-- Ajout affichage pi√®ces -->
            <div class="score-row" style="color:#FBD000; font-weight:bold;"><span>Pi√®ces gagn√©es :</span><span id="winCoins">0</span></div>
            <div class="score-total"><span>TOTAL :</span><span id="finalScore">0</span></div>
        </div>

        <div id="albumUnlockMsg" style="color: #44D62C; font-weight: bold; margin: 10px 0; display: none;">
            üéÅ Nouveaux stickers d√©bloqu√©s dans l'album !
        </div>

        <button class="btn-level" onclick="goToMainMenu()">Menu Principal</button>
        <button class="btn-level" onclick="restartCurrentLevel()">Rejouer</button>
    </div>

    <div class="end-msg" id="loseMessage" style="background: rgba(0,0,0,0.9);">
        <h2 id="loseTitle" style="color: #ff4d4d;">GAME OVER</h2>
        <p id="loseText" style="font-size: 1.5rem;">Bowser a gagn√©...</p>
        <!-- Ajout affichage pi√®ces -->
        <p style="color:#FBD000; font-weight:bold; font-size:1.2rem; margin-bottom:20px;">Pi√®ces gagn√©es : <span id="loseCoins">0</span></p>

        <button class="btn-level" onclick="restartCurrentLevel()">R√©essayer</button>
        <button class="btn-level" onclick="goToMainMenu()">Menu Principal</button>
    </div>

    <script src="script.js"></script>
</body>
</html>
